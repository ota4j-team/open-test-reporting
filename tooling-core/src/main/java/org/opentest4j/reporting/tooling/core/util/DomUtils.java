package org.opentest4j.reporting.tooling.core.util;

import org.opentest4j.reporting.schema.QualifiedName;
import org.w3c.dom.Element;
import org.w3c.dom.NamedNodeMap;
import org.w3c.dom.Node;
import org.w3c.dom.NodeList;

import java.util.function.IntFunction;
import java.util.stream.IntStream;
import java.util.stream.Stream;

/**
 * Internal utils to work with DOM types
 */
public class DomUtils {

    private DomUtils() {
    }

    public static Stream<Node> stream(NodeList nodeList) {
        return stream(nodeList.getLength(), nodeList::item);
    }

    public static Stream<Node> stream(NamedNodeMap namedNodeMap) {
        return stream(namedNodeMap.getLength(), namedNodeMap::item);
    }

    private static Stream<Node> stream(int length, IntFunction<Node> item) {
        return IntStream.range(0, length).mapToObj(item);
    }

    public static boolean matches(QualifiedName qualifiedName, Element element) {
        return qualifiedName.getNamespace().getUri().equals(element.getNamespaceURI())
                && qualifiedName.getSimpleName().equals(element.getLocalName());
    }
}
